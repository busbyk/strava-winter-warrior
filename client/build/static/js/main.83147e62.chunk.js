(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{33:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),c=n.n(a),s=n(19),i=n.n(s),o=n(17),l=n(21),u=n(4),j=n.n(u),h=n(8),b=n(11),d=Object(a.createContext)();function p(e){var t=e.children,n=function(){var e=Object(a.useState)(null),t=Object(b.a)(e,2),n=t[0],r=t[1],c=function(){var e=Object(h.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:t=e.sent,r(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),r(null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(h.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(null);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return(t=Object(h.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:t=e.sent,r(t),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),r(null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}e()}),[]),{user:n,login:c,logout:s}}();return Object(r.jsx)(d.Provider,{value:n,children:t})}var f=function(){return Object(a.useContext)(d)};function x(){return O.apply(this,arguments)}function O(){return(O=Object(h.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user",{method:"GET",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Credentials":!0}});case 2:if(200!==(t=e.sent).status){e.next=5;break}return e.abrupt("return",t.json());case 5:throw new Error("failed to authenticate user");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){var t=f();function n(){return(n=Object(h.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.logout();case 2:window.open("/auth/logout","_self");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.jsx)("nav",{className:"navbar is-light",role:"navigation","aria-label":"main navigation",children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("div",{className:"navbar-brand",children:Object(r.jsx)("a",{className:"navbar-item",href:"/",children:Object(r.jsx)("h1",{className:"title",children:"Winter Warrior Scoreboard"})})}),Object(r.jsx)("div",{id:"navbarBasicExample",className:"navbar-menu",children:Object(r.jsx)("div",{className:"navbar-end",children:Object(r.jsx)("div",{className:"navbar-item",children:t.user&&Object(r.jsxs)("div",{className:"level",children:[Object(r.jsx)("div",{className:"level-item",children:Object(r.jsxs)("span",{className:"mr-4",children:["Hey there, ",t.user.displayName]})}),Object(r.jsx)("div",{className:"level-item",children:Object(r.jsx)("button",{className:"button is-small",onClick:function(){return n.apply(this,arguments)},children:Object(r.jsx)("strong",{children:"Log out"})})})]})})})})]})})}function m(e){var t=e.user,n=t.displayName,a=t.firstname,c=t.lastname,s=t.stravaId,i=t.profileImageUrl;return Object(r.jsx)("div",{className:"box",children:Object(r.jsxs)("article",{className:"media",children:[Object(r.jsx)("div",{className:"media-left",children:Object(r.jsx)("figure",{className:"image is-64x64",children:Object(r.jsx)("img",{src:i||"https://bulma.io/images/placeholders/128x128.png",alt:"Profile"})})}),Object(r.jsx)("div",{className:"media-content",children:Object(r.jsx)("div",{className:"content",children:Object(r.jsx)("p",{children:Object(r.jsx)("a",{href:"https://www.strava.com/athelete/".concat(s),children:Object(r.jsx)("strong",{children:n||"".concat(a," ").concat(c)})})})})})]})})}function w(){var e=Object(a.useState)(null),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(b.a)(s,2),o=i[0],l=i[1];return Object(a.useEffect)((function(){function e(){return(e=Object(h.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g();case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),l(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(r.jsx)("section",{className:"section",children:Object(r.jsxs)("div",{className:"container",children:[o&&Object(r.jsxs)("div",{class:"notification is-warning",children:[Object(r.jsxs)("p",{children:["Looks like you're not part of the"," ",Object(r.jsx)("strong",{children:"Winter Warrior 2021"})," club on Strava."]}),Object(r.jsx)("br",{}),Object(r.jsxs)("p",{children:["Please go"," ",Object(r.jsx)("strong",{children:Object(r.jsx)("a",{href:"https://www.strava.com/clubs/WW2021",target:"_blank",rel:"noreferrer",children:"join that group on Strava"})})," ","and then reload this page."]})]}),n&&n.map((function(e){return Object(r.jsx)(m,{user:e})}))]})})}function g(){return N.apply(this,arguments)}function N(){return(N=Object(h.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/strava/warriors",{method:"GET",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","Access-Control-Allow-Credentials":!0}});case 2:if(200!==(t=e.sent).status){e.next=5;break}return e.abrupt("return",t.json());case 5:throw new Error("failed to authenticate user");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=n(2);function k(e){return f().user?Object(r.jsx)(y.a,{to:{pathname:"/scoreboard",state:{from:"/"}}}):Object(r.jsx)("section",{className:"hero is-link is-fullheight-with-navbar",children:Object(r.jsx)("div",{className:"hero-body",children:Object(r.jsxs)("div",{className:"container has-text-centered",children:[Object(r.jsx)("p",{className:"title",children:"Welcome to the 2020 Winter Warrior Scoreboard"}),Object(r.jsx)("button",{className:"button is-primary",onClick:C,children:Object(r.jsx)("strong",{children:"Log in with Strava"})})]})})})}function C(){window.open("/auth/strava","_self")}var S=n(14);function W(){return Object(r.jsx)(p,{children:Object(r.jsxs)(S.a,{children:[Object(r.jsx)(v,{}),Object(r.jsxs)(y.d,{children:[Object(r.jsx)(y.b,{exact:!0,path:"/",children:Object(r.jsx)(k,{})}),Object(r.jsx)(E,{path:"/scoreboard",children:Object(r.jsx)(w,{})})]})]})})}function E(e){var t=e.children,n=Object(l.a)(e,["children"]),a=f();return Object(r.jsx)(y.b,Object(o.a)(Object(o.a)({},n),{},{render:function(e){var n=e.location;return a.user?t:Object(r.jsx)(y.a,{to:{pathname:"/",state:{from:n}}})}}))}n(33);var A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,35)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(W,{})}),document.getElementById("root")),A()}},[[34,1,2]]]);
//# sourceMappingURL=main.83147e62.chunk.js.map