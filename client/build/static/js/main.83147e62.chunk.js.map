{"version":3,"sources":["hooks/use-auth.js","components/NavBar.js","components/WarriorCard.js","components/Scoreboard.js","components/LandingPage.js","App.js","reportWebVitals.js","index.js"],"names":["authContext","createContext","ProvideAuth","children","auth","useState","user","setUser","login","a","getLoggedInUser","console","error","logout","useEffect","fetchData","useProvideAuth","Provider","value","useAuth","useContext","fetch","method","credentials","headers","Accept","res","status","json","Error","NavBar","props","window","open","className","role","aria-label","href","id","displayName","onClick","WarriorCard","firstname","lastname","stravaId","profileImageUrl","src","alt","Scoreboard","warriors","setWarriors","setError","getWarriors","class","target","rel","map","warrior","LandingPage","to","pathname","state","from","handleLoginClick","App","exact","path","PrivateRoute","rest","render","location","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.83147e62.chunk.js","sourcesContent":["import React, { useState, useEffect, useContext, createContext } from 'react'\n\nconst authContext = createContext()\n\n// Provider component that wraps your app and makes auth object ...\n// ... available to any child component that calls useAuth().\nexport function ProvideAuth({ children }) {\n  const auth = useProvideAuth()\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>\n}\n\n// Hook for child components to get the auth object ...\n// ... and re-render when it changes.\nexport const useAuth = () => {\n  return useContext(authContext)\n}\n\n// Provider hook that creates auth object and handles state\nfunction useProvideAuth() {\n  const [user, setUser] = useState(null)\n\n  const login = async () => {\n    try {\n      const user = await getLoggedInUser()\n      setUser(user)\n    } catch (err) {\n      console.error(err)\n      setUser(null)\n    }\n  }\n\n  const logout = async () => {\n    setUser(null)\n  }\n\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        const user = await getLoggedInUser()\n        setUser(user)\n      } catch (err) {\n        console.error(err)\n        setUser(null)\n      }\n    }\n    fetchData()\n  }, [])\n\n  return {\n    user,\n    login,\n    logout,\n  }\n}\n\nasync function getLoggedInUser() {\n  const res = await fetch('/user', {\n    method: 'GET',\n    credentials: 'include',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      'Access-Control-Allow-Credentials': true,\n    },\n  })\n  if (res.status === 200) return res.json()\n  throw new Error('failed to authenticate user')\n}\n","import { useAuth } from '../hooks/use-auth'\n\nexport default function NavBar(props) {\n  const auth = useAuth()\n\n  async function handleLogoutClick() {\n    await auth.logout()\n    window.open('/auth/logout', '_self') //TODO change this to be a fetch and on the server just log the user out, update Router to redirect unknown routes to /\n  }\n\n  return (\n    <nav\n      className='navbar is-light'\n      role='navigation'\n      aria-label='main navigation'\n    >\n      <div className='container'>\n        <div className='navbar-brand'>\n          <a className='navbar-item' href='/'>\n            <h1 className='title'>Winter Warrior Scoreboard</h1>\n          </a>\n        </div>\n        <div id='navbarBasicExample' className='navbar-menu'>\n          <div className='navbar-end'>\n            <div className='navbar-item'>\n              {auth.user && (\n                <div className='level'>\n                  <div className='level-item'>\n                    <span className='mr-4'>\n                      Hey there, {auth.user.displayName}\n                    </span>\n                  </div>\n                  <div className='level-item'>\n                    <button\n                      className='button is-small'\n                      onClick={handleLogoutClick}\n                    >\n                      <strong>Log out</strong>\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </nav>\n  )\n}\n","export default function WarriorCard(props) {\n  const {\n    displayName,\n    firstname,\n    lastname,\n    stravaId,\n    profileImageUrl,\n  } = props.user\n  return (\n    <div className='box'>\n      <article className='media'>\n        <div className='media-left'>\n          <figure className='image is-64x64'>\n            <img\n              src={\n                profileImageUrl ||\n                'https://bulma.io/images/placeholders/128x128.png'\n              }\n              alt='Profile'\n            />\n          </figure>\n        </div>\n        <div className='media-content'>\n          <div className='content'>\n            <p>\n              <a href={`https://www.strava.com/athelete/${stravaId}`}>\n                <strong>{displayName || `${firstname} ${lastname}`}</strong>\n              </a>\n            </p>\n          </div>\n        </div>\n      </article>\n    </div>\n  )\n}\n","import React, { useEffect, useState } from 'react'\nimport WarriorCard from './WarriorCard'\n\nexport default function Scoreboard() {\n  const [warriors, setWarriors] = useState(null)\n  const [error, setError] = useState(null)\n\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        const warriors = await getWarriors()\n        setWarriors(warriors)\n      } catch (err) {\n        setError(err)\n      }\n    }\n    fetchData()\n  }, [])\n\n  return (\n    <section className='section'>\n      <div className='container'>\n        {error && (\n          <div class='notification is-warning'>\n            <p>\n              Looks like you're not part of the{' '}\n              <strong>Winter Warrior 2021</strong> club on Strava.\n            </p>\n            <br />\n            <p>\n              Please go{' '}\n              <strong>\n                <a\n                  href='https://www.strava.com/clubs/WW2021'\n                  target='_blank'\n                  rel='noreferrer'\n                >\n                  join that group on Strava\n                </a>\n              </strong>{' '}\n              and then reload this page.\n            </p>\n          </div>\n        )}\n        {warriors && warriors.map((warrior) => <WarriorCard user={warrior} />)}\n      </div>\n    </section>\n  )\n}\n\nasync function getWarriors() {\n  const res = await fetch('/strava/warriors', {\n    method: 'GET',\n    credentials: 'include',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      'Access-Control-Allow-Credentials': true,\n    },\n  })\n  if (res.status === 200) return res.json()\n  throw new Error('failed to authenticate user')\n}\n","import { Redirect } from 'react-router-dom'\nimport { useAuth } from '../hooks/use-auth'\n\nexport default function LandingPage(props) {\n  const auth = useAuth()\n  if (auth.user) {\n    return (\n      <Redirect\n        to={{\n          pathname: '/scoreboard',\n          state: { from: '/' },\n        }}\n      />\n    )\n  } else {\n    return (\n      <section className='hero is-link is-fullheight-with-navbar'>\n        <div className='hero-body'>\n          <div className='container has-text-centered'>\n            <p className='title'>\n              Welcome to the 2020 Winter Warrior Scoreboard\n            </p>\n            <button className='button is-primary' onClick={handleLoginClick}>\n              <strong>Log in with Strava</strong>\n            </button>\n          </div>\n        </div>\n      </section>\n    )\n  }\n}\n\nfunction handleLoginClick() {\n  window.open('/auth/strava', '_self')\n}\n","import NavBar from './components/NavBar'\nimport Scoreboard from './components/Scoreboard'\nimport LandingPage from './components/LandingPage'\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom'\nimport { ProvideAuth, useAuth } from './hooks/use-auth'\n\nexport default function App() {\n  return (\n    <ProvideAuth>\n      <Router>\n        <NavBar />\n        <Switch>\n          <Route exact path='/'>\n            <LandingPage />\n          </Route>\n          <PrivateRoute path='/scoreboard'>\n            <Scoreboard />\n          </PrivateRoute>\n        </Switch>\n      </Router>\n    </ProvideAuth>\n  )\n}\n\nfunction PrivateRoute({ children, ...rest }) {\n  const auth = useAuth()\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        auth.user ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: '/',\n              state: { from: location },\n            }}\n          />\n        )\n      }\n    />\n  )\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport './App.sass'\nimport reportWebVitals from './reportWebVitals'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}